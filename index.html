<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–§–æ—Ç–æ–∞–ª—å–±–æ–º üíñ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #fff0f6;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #d6336c;
    }
    #gallery {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
      justify-content: center;
    }
    .photo {
      width: 200px;
    }
    .photo img {
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    input[type="file"] {
      margin-top: 15px;
    }
    button {
      padding: 10px 20px;
      margin-top: 15px;
      border: none;
      border-radius: 8px;
      background: #ff4d94;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover {
      background: #e73370;
    }
  </style>
</head>
<body>
  <h1>–§–æ—Ç–æ–∞–ª—å–±–æ–º üíñ</h1>

  <input type="file" id="fileInput" multiple>
  <br>
  <button onclick="uploadImages()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ</button>
  <button onclick="clearGallery()">–û—á–∏—Å—Ç–∏—Ç—å –∞–ª—å–±–æ–º</button>

  <div id="gallery"></div>

  <script>
    const API_KEY = "876c7823f9f0a390dbd7586dca84c168";

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ñ–æ—Ç–æ –∏–∑ localStorage
    window.onload = () => {
      const saved = JSON.parse(localStorage.getItem("photos")) || [];
      saved.forEach(url => addPhoto(url));
    };

    async function uploadImages() {
      const files = document.getElementById("fileInput").files;
      if (!files.length) return alert("–í—ã–±–µ—Ä–∏ —Ñ–æ—Ç–æ!");

      for (let file of files) {
        const formData = new FormData();
        formData.append("image", file);

        try {
          const res = await fetch(`https://api.imgbb.com/1/upload?key=${API_KEY}`, {
            method: "POST",
            body: formData
          });
          const data = await res.json();
          if (data.success) {
            addPhoto(data.data.url);
            savePhoto(data.data.url);
          } else {
            alert("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: " + data.error.message);
          }
        } catch (e) {
          console.error(e);
          alert("–û—à–∏–±–∫–∞ —Å–µ—Ç–∏");
        }
      }
      document.getElementById("fileInput").value = "";
    }

    function addPhoto(url) {
      const gallery = document.getElementById("gallery");
      const div = document.createElement("div");
      div.className = "photo";
      div.innerHTML = `<img src="${url}" alt="–§–æ—Ç–æ">`;
      gallery.appendChild(div);
    }

    function savePhoto(url) {
      const saved = JSON.parse(localStorage.getItem("photos")) || [];
      saved.push(url);
      localStorage.setItem("photos", JSON.stringify(saved));
    }

    function clearGallery() {
      if (confirm("–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Ñ–æ—Ç–æ?")) {
        localStorage.removeItem("photos");
        document.getElementById("gallery").innerHTML = "";
      }
    }
  </script>
</body>
</html>
