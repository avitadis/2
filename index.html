<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–î–ª—è –º–æ–µ–π –ó–µ—Ñ–∏—Ä–∫–∏</title>
<style>
  body {
    margin: 0;
    font-family: "Segoe UI", sans-serif;
    background: url("background.jpg") no-repeat center center/cover;
    color: white;
    text-align: center;
    overflow-x: hidden;
  }

  nav {
    display: flex;
    justify-content: center;
    gap: 15px;
    background: #ff4b5c;
    padding: 10px 0;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  nav button {
    padding: 10px 20px;
    border: none;
    border-radius: 25px;
    background: white;
    color: #ff4b5c;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }
  nav button:hover { background: #ffe5e9; }
  nav button.active { background: #fff0f2; border: 2px solid #ff4b5c; }

  .tab {
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 20px;
    min-height: 80vh;
  }
  .tab.active { display: flex; }

  /* –ì–ª–∞–≤–Ω–∞—è */
  h1 { font-size: 2.5rem; margin: 0 0 15px; text-shadow: 2px 2px 10px rgba(0,0,0,0.6); }
  p { font-size: 1.2rem; max-width: 350px; margin-bottom: 20px; white-space: pre-line; text-shadow: 1px 1px 5px rgba(0,0,0,0.6); }
  .main-btn {
    padding: 12px 24px;
    font-size: 1rem;
    border: none;
    border-radius: 25px;
    background: white;
    color: #ff4b5c;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.3s;
  }
  .main-btn:hover { transform: scale(1.1); }
  .click-counter { font-size: 1rem; margin: 10px 0; text-shadow: 1px 1px 5px rgba(0,0,0,0.6); }

  footer { margin-top: 20px; font-size: 1rem; max-width: 350px; }

  /* –°–µ—Ä–¥–µ—á–∫–∏ */
  .heart {
    position: absolute;
    width: 20px; height: 20px;
    background: red; transform: rotate(45deg);
    animation: floatUp 4s linear infinite;
    opacity: 0.7;
  }
  .heart::before, .heart::after { content:""; position:absolute; width:20px; height:20px; background:red; border-radius:50%; }
  .heart::before { top:-10px; left:0; } .heart::after { left:-10px; top:0; }
  @keyframes floatUp { 0% { transform: translateY(0) rotate(45deg); opacity:1; } 100% { transform: translateY(-600px) rotate(45deg); opacity:0; } }

  /* Toast */
  .toast {
    position: absolute;
    left: 50%;
    bottom: -60px;
    transform: translateX(-50%) scale(0.9);
    background: rgba(0,0,0,0.85);
    color: white;
    padding: 16px 30px;
    border-radius: 30px;
    font-size: 1.3rem;
    font-weight: bold;
    box-shadow: 0 6px 20px rgba(255,100,150,0.5);
    z-index: 1000;
    opacity: 0;
    transition: all 0.4s cubic-bezier(0.25,0.8,0.25,1);
    white-space: nowrap;
    backdrop-filter: blur(5px);
    pointer-events: none;
  }
  .toast.show { bottom: 40px; transform: translateX(-50%) scale(1); opacity: 1; }

  /* –ì–∞–ª–µ—Ä–µ—è */
  .gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 12px;
    width: 90%;
  }
  .gallery img {
    width: 100%;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    transition: transform 0.3s;
  }
  .gallery img:hover { transform: scale(1.05); }

  /* –ó–∞–≥—Ä—É–∑–∫–∞ */
  .upload-box {
    margin: 20px auto;
    padding: 20px;
    border: 2px dashed #ff4b5c;
    border-radius: 20px;
    max-width: 400px;
    background: #fff5f6;
    color: #333;
  }
  input[type="file"] { display: none; }
  label.upload-btn {
    display: inline-block;
    padding: 12px 24px;
    background: #ff4b5c;
    color: white;
    border-radius: 25px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 10px;
    transition: background 0.3s;
  }
  label.upload-btn:hover { background: #e53b4c; }
  #uploadStatus p { margin: 5px 0; color: #333; font-weight: bold; }
</style>
</head>
<body>

<nav>
  <button class="tab-btn active" data-tab="home">–ì–ª–∞–≤–Ω–∞—è</button>
  <button class="tab-btn" data-tab="gallery">–ì–∞–ª–µ—Ä–µ—è</button>
  <button class="tab-btn" data-tab="upload">–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ</button>
</nav>

<!-- Toast -->
<div id="loveToast" class="toast">–ò –ë–£–î–£ –õ–Æ–ë–ò–¢–¨ –í–°–ï–ì–î–ê üíñ</div>

<!-- –ì–ª–∞–≤–Ω–∞—è -->
<div id="home" class="tab active">
  <h1>–ó–µ—Ñ–∏—Ä–∫–∞ –º–æ—è,<br> —è —Ç–µ–±—è –ª—é–±–ª—é ‚ù§Ô∏è</h1>
  <p>–Ø –æ —Ç–µ–±–µ, –∫—Ç–æ –º–Ω–µ –≤—Å–µ–≥–æ –¥–æ—Ä–æ–∂–µ,
–±–æ—é—Å—å –ø–∏—Å–∞—Ç—å.
–í–¥—Ä—É–≥ –∫—Ç–æ-–Ω–∏–±—É–¥—å, –ª—é–±—è,
–∑–∞–≥–æ–≤–æ—Ä–∏—Ç —Å –¥—Ä—É–≥–æ–π,
–ª—é–±–∏–º–æ–π —Ç–æ–∂–µ,
—Å–ª–æ–≤–∞–º–∏, —á—Ç–æ –Ω–∞—à—ë–ª
—è –¥–ª—è —Ç–µ–±—è.
–°–ø–∞—Å–∏–±–æ —Ç–µ–±–µ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏ üíï</p>
  <button class="main-btn" id="mainBtn">–ù–∞–∂–º–∏ –º–µ–Ω—è</button>
  <div class="click-counter">–ö–ª–∏–∫–æ–≤: <span id="clickCounter">0</span></div>
  <footer>–ï—Å–ª–∏ –≤–¥—Ä—É–≥ —Ç—ã —Å—Ç–∞–ª–∞ –∑–∞–±—ã–≤–∞—Ç—å, –∫–∞–∫ —è —Ç–µ–±—è –ª—é–±–ª—é, –æ–Ω –±—É–¥–µ—Ç –∑–¥–µ—Å—å –≤—Å–µ–≥–¥–∞ üåπ</footer>
</div>

<!-- –ì–∞–ª–µ—Ä–µ—è -->
<div id="gallery" class="tab">
  <div id="photos" class="gallery"></div>
</div>

<!-- –ó–∞–≥—Ä—É–∑–∫–∞ -->
<div id="upload" class="tab">
  <div class="upload-box">
    <h3>–í—ã–±–µ—Ä–∏ —Ñ–æ—Ç–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ üíñ</h3>
    <input type="file" id="fileInput" accept="image/*" multiple>
    <label for="fileInput" class="upload-btn">–í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ç–æ</label>
    <div id="uploadStatus"></div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
import { getStorage, ref, uploadBytesResumable, getDownloadURL, listAll } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyDF9V1fKurbqRPgv31mabmazhbKXtKfibE",
  authDomain: "loveyou-eaa77.firebaseapp.com",
  projectId: "loveyou-eaa77",
  storageBucket: "loveyou-eaa77.appspot.com",
  messagingSenderId: "497705197325",
  appId: "1:497705197325:web:3341f296e4d0e3cc2f9a44"
};

const app = initializeApp(firebaseConfig);
const storage = getStorage(app);

const photosDiv = document.getElementById("photos");
const fileInput = document.getElementById("fileInput");
const statusDiv = document.getElementById("uploadStatus");

async function loadGallery() {
  photosDiv.innerHTML = "";
  const listRef = ref(storage, "photos");
  const res = await listAll(listRef);
  for (const item of res.items) {
    const url = await getDownloadURL(item);
    const img = document.createElement("img");
    img.src = url;
    photosDiv.appendChild(img);
  }
}
loadGallery();

fileInput.addEventListener("change", async (e) => {
  const files = e.target.files;
  if (!files.length) return;
  statusDiv.innerHTML = "";
  for (const file of files) {
    const fileRef = ref(storage, "photos/" + Date.now() + "_" + file.name);
    const uploadTask = uploadBytesResumable(fileRef, file);

    const statusItem = document.createElement("p");
    statusItem.textContent = `${file.name}: 0%`;
    statusDiv.appendChild(statusItem);

    uploadTask.on("state_changed",
      snapshot => {
        const progress = (snapshot.bytesTransferred / snapshot.totalBytes * 100).toFixed(0);
        statusItem.textContent = `${file.name}: ${progress}%`;
      },
      error => {
        statusItem.textContent = `${file.name}: –û—à–∏–±–∫–∞`;
        console.error(error);
      },
      async () => {
        const url = await getDownloadURL(uploadTask.snapshot.ref);
        statusItem.textContent = `${file.name}: –ó–∞–≥—Ä—É–∂–µ–Ω–æ!`;
        const img = document.createElement("img");
        img.src = url;
        photosDiv.appendChild(img);
      }
    );
  }
  fileInput.value = "";
});
</script>

<script>
  // –í–∫–ª–∞–¥–∫–∏
  const tabBtns = document.querySelectorAll(".tab-btn");
  const tabs = document.querySelectorAll(".tab");
  tabBtns.forEach(btn => {
    btn.addEventListener("click", () => {
      tabBtns.forEach(b => b.classList.remove("active"));
      tabs.forEach(t => t.classList.remove("active"));
      btn.classList.add("active");
      document.getElementById(btn.dataset.tab).classList.add("active");
    });
  });

  // –°—á–µ—Ç—á–∏–∫ –∏ —Å–µ—Ä–¥–µ—á–∫–∏
  const counterElement = document.getElementById("clickCounter");
  let count = parseInt(localStorage.getItem("zeffirkaClicks")) || 0;
  counterElement.textContent = count;

  const toast = document.getElementById("loveToast");
  let isAnimating = false;

  function showToast() {
    if (isAnimating) return;
    isAnimating = true;
    toast.classList.remove("show");
    void toast.offsetWidth;
    toast.classList.add("show");
    setTimeout(() => {
      toast.classList.remove("show");
      setTimeout(() => { isAnimating = false; }, 400);
    }, 2500);
  }

  document.getElementById("mainBtn").addEventListener("click", () => {
    count++;
    counterElement.textContent = count;
    localStorage.setItem("zeffirkaClicks", count);
    showToast();
  });

  function createHeart() {
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.style.left = Math.random() * window.innerWidth + "px";
    heart.style.top = window.innerHeight + "px";
    document.body.appendChild(heart);
    setTimeout(() => heart.remove(), 4000);
  }
  setInterval(createHeart, 500);
</script>

</body>
</html>
